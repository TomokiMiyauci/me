---
title: Bitlyã§å‹•çš„ã«çŸ­ç¸® URLã‚’ä½œæˆã—ã¦ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹
description: Bitlyã§çŸ­ç¸®URLã‚’å‹•çš„ã«ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚ã¾ãŸã€ãƒ„ã‚¤ãƒ¼ãƒˆã¯çŸ­ç¸®URLã®æœ‰åŠ¹ãªåˆ©ç”¨å…ˆãªãŸã‚ã€å‹•çš„ãªãƒ„ã‚¤ãƒ¼ãƒˆã®æ–¹æ³•ã‚‚åˆã‚ã›ã¦è§£èª¬ã—ã¾ã™ã€‚
hero: hero.png
thumbnail: thumbnail.png
date: 2021-08-07
slug: /posts/bitly-short-url/
tags:
  - bitly
  - twitter
  - TypeScript
verification:
  os:
    name: macOS
    family: Big Sur
    version: 11.2.1
  packages:
    node:
      - name: bitly
        version: 7.1.2
      - name: twitter-api-v2
        version: 1.1.1
---

## ã¯ã˜ã‚ã«

Bitly ã¨ã¯å…¬å¼ã§ã¯æ¬¡ã®ã‚ˆã†ã«èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

> Bitly is a link management platform that lets you harness the power of your links by shortening, sharing, managing and analyzing links to your content.

æ—¥æœ¬èªè¨³:

> Bitly ã¯ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã®ãƒªãƒ³ã‚¯ã‚’çŸ­ç¸®ã€å…±æœ‰ã€ç®¡ç†ã€åˆ†æã™ã‚‹ã“ã¨ã§ã€ãƒªãƒ³ã‚¯ã®åŠ›ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãƒªãƒ³ã‚¯ç®¡ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚

Bitly ã‚’ä½¿ã†ã“ã¨ã§ã€çŸ­ç¸® URL ã®ä½œæˆã ã‘ã§ãªãã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«ã‚¯ãƒªãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã—ãŸã‚Šã€çŸ­ç¸® URL ã«ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å‰²ã‚Šå½“ã¦ãŸã‚Šã§ãã¾ã™ã€‚
ã¾ãŸã€API ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å‹•çš„ã«çŸ­ç¸® URL ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚

çŸ­ç¸® URL ã®æœ€ã‚‚æœ‰åŠ›ãªä½¿ã„æ‰€ã¯ã€ãƒ„ã‚¤ãƒ¼ãƒˆã ã¨æ€ã„ã¾ã™ã€‚280 æ–‡å­—ã®æ–‡å­—æ•°åˆ¶é™ãŒã‚ã‚‹ãŸã‚ã€URL ã¯ãªã‚‹ã¹ãçŸ­ãã—ãŸã„ã‚‚ã®ã§ã™ã€‚

ä»Šå›ã¯ã€Bitly ã‚’ä½¿ã£ã¦å‹•çš„ã«çŸ­ç¸® URL ã‚’ä½œæˆã—ã€å‹•çš„ã«ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## Bitly ã«ã¤ã„ã¦

Bitly ã¯ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®ç™»éŒ²ãŒä¸è¦ãªãƒ•ãƒªãƒ¼ãƒ—ãƒ©ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚
ãƒ•ãƒªãƒ¼ãƒ—ãƒ©ãƒ³ã§ã¯ã€æœˆã« 1000 å€‹ã¾ã§çŸ­ç¸® URL ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã“ã®ã‚µã‚¤ãƒˆã® URL ã‚’çŸ­ç¸®ã™ã‚‹ã¨ã€

https://miyauchi.dev/ -> https://bit.ly/3jzAv7l

ã¨ã„ã† URL ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚

ãƒ•ãƒªãƒ¼ãƒ—ãƒ©ãƒ³ã§ã¯ `bit.ly` ã¨ã„ã†ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å¤‰æ›´ã§ãã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€ãƒ•ãƒªãƒ¼ãƒ—ãƒ©ãƒ³ã§ã‚‚ãƒ‘ã‚¹ã®éƒ¨åˆ†ã¯ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

ä¾‹ãˆã°ã€ä¸Šã®çŸ­ç¸® URL ã® `3jzAv7l` ã¨ã„ã†ãƒ‘ã‚¹ã¯ã€ã™ã§ã«å–å¾—ã•ã‚Œã¦ã„ãªã„å¥½ããªãƒ‘ã‚¹ã«å¤‰æ›´ã§ãã¾ã™ã€‚
ã“ã®ãƒ‘ã‚¹ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã¯ã€ãƒ•ãƒªãƒ¼ãƒ—ãƒ©ãƒ³ã§ã¯æœˆã« 50 å€‹ã¾ã§ç”Ÿæˆã§ãã¾ã™ã€‚

ä»–ã®ãƒ—ãƒ©ãƒ³ã”ã¨ã®é•ã„ã«ã¤ã„ã¦ã¯ [Upgrade your links](https://bitly.com/pages/pricing)ã‚’ç¢ºèªãã ã•ã„ã€‚

## Bitly ã§çŸ­ç¸® URL ã‚’å‹•çš„ã«ç”Ÿæˆã™ã‚‹

çŸ­ç¸® URL ã®å‹•çš„ç”Ÿæˆã«ã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒå¿…è¦ã§ã™ã€‚
ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¯ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚Œã°ç”Ÿæˆã§ãã‚‹ã®ã§ã€ [Authentication](https://dev.bitly.com/docs/getting-started/authentication/) ã‚„ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

çŸ­ç¸® URL ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

https://api-ssl.bitly.com/v4/shorten

ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä»˜ä¸ã—ã¦ã€body ã«çŸ­ç¸®ã—ãŸã„ URL ã‚’æŒ‡å®šã—ã¾ã™ã€‚

`curl` ã§ã®ä¾‹ã‚’å‚è€ƒã«ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã¦ã‚‚ã„ã„ã§ã—ã‚‡ã†ã€‚

```bash
curl \
-H 'Authorization: Bearer {TOKEN}' \
-H 'Content-Type: application/json' \
-X POST \
-d '{
  "long_url": "https://miyauchi.dev/"
}' \
https://api-ssl.bitly.com/v4/shorten
```

ã¾ãŸã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```json
{
  "created_at": "2021-08-07T06:45:15+0000",
  "id": "<id>",
  "link": "https://bit.ly/3jzAv7l",
  "custom_bitlinks": [],
  "long_url": "https://miyauchi.dev/",
  "archived": false,
  "tags": [],
  "deeplinks": [],
  "references": {
    "group": "https://api-ssl.bitly.com/v4/groups/<group>"
  }
}
```

JSON ã® `link` ãŒçŸ­ç¸® URL ã§ã™ã€‚ã¾ãŸã€`long_url` ã¯å…ƒã® URL ã‚’è¡¨ã—ã¾ã™ã€‚
çŸ­ç¸® URL ã¯å…ƒã® URL ã¨ä¸€å¯¾ä¸€ã§ã™ã€‚ã¤ã¾ã‚Šã€åŒä¸€ URL ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã‚‚ã€åŒã˜çŸ­ç¸® URL ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã•ã‚Œã¾ã™ã€‚
ã‚ˆã£ã¦ã€åŒä¸€ URL ã«å¯¾ã™ã‚‹çŸ­ç¸® URL ç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€æœˆ 1000 ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚’æ¶ˆè²»ã—ã¾ã›ã‚“ã€‚

`fetch` ãªã©ã§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç›´æ¥å‘¼ã³å‡ºã—ã¦ã‚‚ã„ã„ã§ã™ãŒã€
Bitly ã«ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã‚‹ã®ã§ã€ãã‚Œã‚’ä½¿ã„ã¾ã—ã‚‡ã†ã€‚

### Bitly ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

Bitly ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã“ã¨ã§ã€ TypeScript ã§å‹å®‰å…¨ã«é‹ç”¨ã§ãã¾ã™ã€‚

<CodeGroups>
  <CodeGroup label="Yarn" active>

```bash
yarn add bitly
```

  </CodeGroup>

  <CodeGroup label="NPM">

```bash
npm i bitly
```

  </CodeGroup>
</CodeGroups>

<Alert type="warning">Top level await æ§‹æ–‡ã‚’ä½¿ã£ã¦ã„ã¾ã™</Alert>

```ts
import { BitlyClient, isBitlyErrResponse } from 'bitly'
const bitly = new BitlyClient('<access-token>')

try {
  const bitlyLink = await bitly.shorten('https://miyauchi.dev/')
} catch (error) {
  if (isBitlyErrResponse(error)) {
    // bitly error
  } else if (error.isAxiosError) {
    // axios error
  }
}
```

`shorten` ãƒ¡ã‚½ãƒƒãƒ‰ãŒã€ä¸Šã§è¦‹ãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ç›¸å½“ã—ã¾ã™ã€‚
Bitly ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ http ãƒªã‚¯ã‚¨ã‚¹ãƒˆã« `axios` ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚
ã‚ˆã£ã¦ã€ã‚¨ãƒ©ãƒ¼æ™‚ã¯ `isBitlyErrResponse` é–¢æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€Bitly ã‹ã‚‰ã®ã‚¨ãƒ©ãƒ¼ãªã®ã‹ã€
ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãªã®ã‹è­˜åˆ¥ã§ãã¾ã™ã€‚

ã¾ãŸã€Promise ã® `resolve` ã¯ `BitlyLink` ã¨ã„ã†å‹ã«ãªã£ã¦ã„ã¾ã™ã€‚

```ts
interface BitlyLink {
  created_at: string
  id: string
  link: string
  custom_bitlinks: string[]
  long_url: string
  archived: boolean
  tags: string[]
  deeplinks: DeepLink[]
  references: References
  title?: string
  created_by?: string
}
```

`BitlyLink` å‹ã«ã¯ã€/v4/shorten ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¯ãªã„ `title` ã¨ `created_by` ãŒ Optional ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚

`title` ã¯ URL å…ˆã® HTML ã® `title` ã‚¿ã‚°ã§ã™ã€‚
ã¾ãŸã€`created_by` ã¯ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåãŒè¨­å®šã•ã‚Œã¾ã™ã€‚

`shorten` ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€€/v4/shorten ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨åŒç­‰ãªã®ã§ã€ä¸Šã®ï¼’ã¤ã®ã‚­ãƒ¼ã¯å–å¾—ã§ãã¾ã›ã‚“ã€‚
ã“ã‚Œã‚‰ã‚‚å«ã‚ã¦å–å¾—ã™ã‚‹ã«ã¯ `info` ãƒ¡ã‚½ãƒƒãƒ‰ãªã©ã‚’ä½¿ã„ã¾ã™ã€‚

```ts
await bitly.info('https://bit.ly/3jzAv7l') // BitlyLink
```

`info` ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã¯ã€Bitly ã«ã‚ˆã£ã¦ä½œã‚‰ã‚ŒãŸçŸ­ç¸® URL ã‚„ id ã‚’æŒ‡å®šã—ã¾ã™ã€‚
åŒã˜ã‚ˆã†ã«ã€`clicks` ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã€ `referrers` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†ã“ã¨ã§ã€çŸ­ç¸® URL ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—ã§ãã¾ã™ã€‚

## ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹

ã›ã£ã‹ãå‹•çš„ã«çŸ­ç¸® URL ã‚’ç”Ÿæˆã—ãŸã®ã§ã€å‹•çš„ã«ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ã—ã¾ã—ã‚‡ã†ã€‚

ãƒ„ã‚¤ãƒ¼ãƒˆã«ã¤ã„ã¦ã¯ä»¥å‰æ›¸ã„ãŸ [TypeScript ã§å‹å®‰å…¨ã«ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹](/posts/tweet-typescript/) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

<CodeGroups>
  <CodeGroup label="Yarn" active>

```bash
yarn add -D twitter-api-v2
```

  </CodeGroup>

  <CodeGroup label="NPM">

```bash
npm i -D twitter-api-v2
```

  </CodeGroup>
</CodeGroups>

```ts
import { BitlyClient } from 'bitly'
import Twitter from 'twitter-api-v2'

const bitly = new BitlyClient('<access-token>')
const client = new Twitter({
  appKey,
  appSecret,
  accessToken,
  accessSecret
})

const bitlyLink = await bitly.shorten('https://miyauchi.dev/')
const tweetContent = bitlyLink // rendering tweet content
await client.v1.tweet(tweetContent)
```

ä¸Šã®ä¾‹ã§ã¯ã€çŸ­ç¸® URL ã‚’ãã®ã¾ã¾ãƒ„ã‚¤ãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

æ™®é€šãƒ„ã‚¤ãƒ¼ãƒˆã«ã¯ URL ä»¥å¤–ã«ã‚‚æƒ…å ±ã‚’è¨˜è¼‰ã™ã‚‹ã¨æ€ã„ã¾ã™ã€‚

ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯ã€æ¬¡ã®ã‚ˆã†ã«è¨˜äº‹ã®å…¬é–‹æ™‚ã«è‡ªå‹•ãƒ„ã‚¤ãƒ¼ãƒˆã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

<blockquote align="center" class="twitter-tweet">
  <p lang="en" dir="ltr">
    ğŸ¤– A new article has been postedğŸš€
    <a href="https://t.co/NIFAHANsof">https://t.co/NIFAHANsof</a>
  </p>
  &mdash; Tomoki Miyauci (@tomoki_miyauci) <a href="https://twitter.com/tomoki_miyauci/status/1422147655577178114?ref_src=twsrc%5Etfw">August 2, 2021</a>
</blockquote>

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ä½¿ã£ã¦ãƒ„ã‚¤ãƒ¼ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ãŒã€
280 æ–‡å­—ã®æ–‡å­—æ•°åˆ¶é™ã«ã¯æ³¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

å‹•çš„ãƒ„ã‚¤ãƒ¼ãƒˆã¯æ–‡å­—æ•°ç®¡ç†ã‚’è‡ªåˆ†ã§ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

ã¾ãŸã®æ©Ÿä¼šã«ã€ãƒ„ã‚¤ãƒ¼ãƒˆã®æ–‡å­—æ•°ç®¡ç†ã«ã¤ã„ã¦æ›¸ããŸã„ã¨æ€ã„ã¾ã™ã€‚
